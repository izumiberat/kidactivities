<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlayIdeas - Activity Generator for Parents</title>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
        }
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--light);
            line-height: 1.6;
            color: var(--dark);
        }
        h1 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 1.5rem;
            padding-top: 1rem;
        }
        .form-group {
            margin-bottom: 1.25rem;
            background: white;
            padding: 1.25rem;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        select, .materials, .duration-options {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
        }
        .materials, .duration-options {
            columns: 2;
            column-gap: 1rem;
        }
        @media (max-width: 480px) {
            .materials, .duration-options {
                columns: 1;
            }
        }
        .checkbox-item, .radio-item {
            margin-bottom: 0.5rem;
            break-inside: avoid;
            display: flex;
            align-items: center;
        }
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            width: 100%;
            font-weight: 600;
            transition: background-color 0.2s;
            margin-bottom: 1.25rem;
        }
        button:hover {
            background-color: var(--secondary);
        }
        #result {
            margin-top: 1.25rem;
            padding: 1.25rem;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: none;
        }
        .activity-text {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }
        .activity-meta {
            display: flex;
            gap: 10px;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: #666;
            flex-wrap: wrap;
        }
        .favorite-btn {
            background-color: var(--warning);
            color: var(--dark);
            display: block;
            margin-top: 1rem;
        }
        .favorite-btn:hover {
            background-color: #e0a800;
        }
        .saved {
            background-color: var(--success);
            color: white;
        }
        #favorites-list {
            display: none;
            margin-top: 1.25rem;
        }
        .tab-buttons {
            display: flex;
            margin-bottom: 1.25rem;
            gap: 0.25rem;
        }
        .tab-btn {
            flex: 1;
            border-radius: 8px 8px 0 0;
        }
        .tab-btn.active {
            background-color: var(--secondary);
        }
        .favorite-item {
            margin-bottom: 1rem;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        input[type="checkbox"], 
        input[type="radio"] {
            margin-right: 8px;
            accent-color: var(--primary);
        }
        .loading {
            text-align: center;
            padding: 1rem;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>PlayIdeas Generator</h1>
    
    <div class="tab-buttons">
        <button class="tab-btn active" onclick="showTab('generator')">Get Ideas</button>
        <button class="tab-btn" onclick="showTab('favorites')">My Favorites</button>
    </div>
    
    <div id="generator-tab">
        <div class="form-group">
            <label for="age">Child's Age:</label>
            <select id="age" onchange="generateActivity()">
                <option value="0-2">0-2 years</option>
                <option value="3-5">3-5 years</option>
                <option value="6-8">6-8 years</option>
                <option value="9-12">9-12 years</option>
                <option value="12+">12+ years</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>Location:</label>
            <div class="radio-item">
                <input type="radio" id="indoor" name="location" value="indoor" checked onchange="generateActivity()">
                <label for="indoor">üè† Indoor</label>
            </div>
            <div class="radio-item">
                <input type="radio" id="outdoor" name="location" value="outdoor" onchange="generateActivity()">
                <label for="outdoor">üå≥ Outdoor</label>
            </div>
        </div>
        
        <div class="form-group">
            <label>Parent Availability:</label>
            <div class="radio-item">
                <input type="radio" id="available" name="availability" value="available" checked onchange="generateActivity()">
                <label for="available">üë®‚Äçüëß I can play too</label>
            </div>
            <div class="radio-item">
                <input type="radio" id="independent" name="availability" value="independent" onchange="generateActivity()">
                <label for="independent">üßí Need independent activity</label>
            </div>
        </div>
        
        <div class="form-group">
            <label>Duration:</label>
            <div class="duration-options">
                <div class="radio-item">
                    <input type="radio" id="quick" name="duration" value="quick" checked onchange="generateActivity()">
                    <label for="quick">‚è±Ô∏è Quick (&lt;15 min)</label>
                </div>
                <div class="radio-item">
                    <input type="radio" id="medium" name="duration" value="medium" onchange="generateActivity()">
                    <label for="medium">‚è≥ Medium (15-30 min)</label>
                </div>
                <div class="radio-item">
                    <input type="radio" id="long" name="duration" value="long" onchange="generateActivity()">
                    <label for="long">‚åõ Long (30+ min)</label>
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <label>Available Materials:</label>
            <div class="materials">
                <div class="checkbox-item"><input type="checkbox" id="paper" value="paper" onchange="generateActivity()"><label for="paper">üìÑ Paper</label></div>
                <div class="checkbox-item"><input type="checkbox" id="pencils" value="pencils" onchange="generateActivity()"><label for="pencils">‚úèÔ∏è Pencils/Markers</label></div>
                <div class="checkbox-item"><input type="checkbox" id="scissors" value="scissors" onchange="generateActivity()"><label for="scissors">‚úÇÔ∏è Scissors</label></div>
                <div class="checkbox-item"><input type="checkbox" id="tape" value="tape" onchange="generateActivity()"><label for="tape">üìè Tape/Glue</label></div>
                <div class="checkbox-item"><input type="checkbox" id="ball" value="ball" onchange="generateActivity()"><label for="ball">üèÄ Ball</label></div>
                <div class="checkbox-item"><input type="checkbox" id="blocks" value="blocks" onchange="generateActivity()"><label for="blocks">üß± Blocks/Lego</label></div>
                <div class="checkbox-item"><input type="checkbox" id="dolls" value="dolls" onchange="generateActivity()"><label for="dolls">üß∏ Dolls/Stuffed Animals</label></div>
                <div class="checkbox-item"><input type="checkbox" id="cards" value="cards" onchange="generateActivity()"><label for="cards">üÉè Playing Cards</label></div>
                <div class="checkbox-item"><input type="checkbox" id="blanket" value="blanket" onchange="generateActivity()"><label for="blanket">üõèÔ∏è Blanket</label></div>
                <div class="checkbox-item"><input type="checkbox" id="none" value="none" onchange="generateActivity()"><label for="none">‚ùå Nothing special</label></div>
            </div>
        </div>
        
        <button onclick="generateActivity()">Generate Play Idea!</button>
        
        <div id="result">
            <div class="loading">Loading activities...</div>
        </div>
    </div>
    
    <div id="favorites-tab" style="display: none;">
        <div id="favorites-list"></div>
    </div>
    
    <script>
        // Global variables
        let activities = [];
        let favorites = JSON.parse(localStorage.getItem('playideas-favorites')) || [];
        
        // Load activities from JSON file
        async function loadActivities() {
            try {
                const response = await fetch('./activities.json?t=' + Date.now());
                if (!response.ok) throw new Error("Failed to load activities");
                const data = await response.json();
                activities = data.activities;
                generateActivity();
            } catch (error) {
                console.error("Error loading activities:", error);
                document.getElementById('result').innerHTML = `
                    <div style="color: var(--danger);">
                        Error loading activities. Please refresh the page.
                    </div>
                `;
                // Fallback activities
                activities = [
                    {
                        id: 999,
                        age: "3-5",
                        location: "indoor",
                        materials: ["none"],
                        independent: true,
                        duration: "quick",
                        text: "Drawing game: Grab paper and pencils to create funny characters together!"
                    }
                ];
            }
        }
        
        // Generate activity based on filters
        function generateActivity() {
            if (activities.length === 0) return;
            
            // Get user selections
            const age = document.getElementById("age").value;
            const location = document.querySelector('input[name="location"]:checked').value;
            const availability = document.querySelector('input[name="availability"]:checked').value;
            const duration = document.querySelector('input[name="duration"]:checked').value;
            
            // Get selected materials
            const materialCheckboxes = document.querySelectorAll('.materials input[type="checkbox"]:checked');
            const materials = Array.from(materialCheckboxes).map(cb => cb.value);
            
            // Find matching activities
            let matchingActivities = activities.filter(activity => 
                activity.age === age && 
                activity.location === location &&
                activity.duration === duration &&
                (availability === "available" || activity.independent === true)
            );
            
            // Filter by materials if any are selected (and not just "none")
            if (materials.length > 0 && !(materials.length === 1 && materials[0] === "none")) {
                matchingActivities = matchingActivities.filter(activity =>
                    activity.materials[0] === "none" || 
                    activity.materials.some(m => materials.includes(m))
                );
            }
            
            // Display result
            const resultDiv = document.getElementById("result");
            if (matchingActivities.length > 0) {
                const randomActivity = matchingActivities[Math.floor(Math.random() * matchingActivities.length)];
                const isFavorite = favorites.includes(randomActivity.id);
                
                resultDiv.innerHTML = `
                    <h3>Here's your play idea:</h3>
                    <div class="activity-meta">
                        <span>${randomActivity.independent ? "üßí Independent" : "üë®‚Äçüëß Parent-assisted"}</span>
                        <span>${randomActivity.duration === "quick" ? "‚è±Ô∏è Quick" : randomActivity.duration === "medium" ? "‚è≥ Medium" : "‚åõ Long"}</span>
                        <span>${randomActivity.location === "indoor" ? "üè† Indoor" : "üå≥ Outdoor"}</span>
                    </div>
                    <div class="activity-text">${randomActivity.text}</div>
                    <button class="favorite-btn ${isFavorite ? 'saved' : ''}" 
                            onclick="toggleFavorite(${randomActivity.id}, this)">
                        ${isFavorite ? '‚òÖ Saved to Favorites' : '‚òÜ Save to Favorites'}
                    </button>
                `;
            } else {
                resultDiv.innerHTML = `
                    <p>No exact matches found. Try:</p>
                    <ul>
                        <li>Selecting fewer materials</li>
                        <li>Changing duration or location</li>
                        <li>Checking 'Nothing special' if you don't have specific items</li>
                    </ul>
                `;
            }
            resultDiv.style.display = "block";
        }
        
        // Toggle activity favorite status
        function toggleFavorite(activityId, button) {
            const index = favorites.indexOf(activityId);
            if (index === -1) {
                favorites.push(activityId);
                button.textContent = '‚òÖ Saved to Favorites';
                button.classList.add('saved');
            } else {
                favorites.splice(index, 1);
                button.textContent = '‚òÜ Save to Favorites';
                button.classList.remove('saved');
            }
            localStorage.setItem('playideas-favorites', JSON.stringify(favorites));
            updateFavoritesList();
        }
        
        // Update favorites list display
        function updateFavoritesList() {
            const favoritesList = document.getElementById("favorites-list");
            if (favorites.length === 0) {
                favoritesList.innerHTML = "<p>You haven't saved any favorites yet. Generate some ideas and click 'Save to Favorites'!</p>";
                return;
            }
            
            let html = "<h3>Your Saved Favorites:</h3>";
            favorites.forEach(favId => {
                const activity = activities.find(a => a.id === favId);
                if (activity) {
                    html += `
                        <div class="favorite-item">
                            <div class="activity-meta">
                                <span>${activity.independent ? "üßí Independent" : "üë®‚Äçüëß Parent-assisted"}</span>
                                <span>${activity.duration === "quick" ? "‚è±Ô∏è Quick" : activity.duration === "medium" ? "‚è≥ Medium" : "‚åõ Long"}</span>
                                <span>${activity.location === "indoor" ? "üè† Indoor" : "üå≥ Outdoor"}</span>
                                <span>Age ${activity.age}</span>
                            </div>
                            <div class="activity-text">${activity.text}</div>
                            <button onclick="removeFavorite(${activity.id})" style="background: var(--danger); padding: 0.25rem 0.5rem; font-size: 0.8rem;">Remove</button>
                        </div>
                    `;
                }
            });
            favoritesList.innerHTML = html;
        }
        
        // Remove from favorites
        function removeFavorite(activityId) {
            favorites = favorites.filter(id => id !== activityId);
            localStorage.setItem('playideas-favorites', JSON.stringify(favorites));
            updateFavoritesList();
            
            // Update any visible favorite button in the results
            const favBtn = document.querySelector(`.favorite-btn[onclick*="${activityId}"]`);
            if (favBtn) {
                favBtn.textContent = '‚òÜ Save to Favorites';
                favBtn.classList.remove('saved');
            }
        }
        
        // Switch between tabs
        function showTab(tabName) {
            document.getElementById('generator-tab').style.display = tabName === 'generator' ? 'block' : 'none';
            document.getElementById('favorites-tab').style.display = tabName === 'favorites' ? 'block' : 'none';
            
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.toLowerCase().includes(tabName));
            });
            
            if (tabName === 'favorites') {
                updateFavoritesList();
            }
        }
        
        // Initialize on load
        window.onload = function() {
            loadActivities();
            updateFavoritesList();
        };
    </script>
</body>
</html>
